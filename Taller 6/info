Los puntos teoricos los puse como comentarios en el mismo codigo de la respectiva pregunta.
